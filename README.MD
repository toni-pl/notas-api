# ğŸ“ Notas API

API REST con interfaz web para gestionar notas personales. Desarrollada con Flask y MariaDB, desplegada con Docker Compose.

## ğŸ“‹ DescripciÃ³n

AplicaciÃ³n web que permite crear, listar y eliminar notas. Incluye:

- **API REST** con 3 endpoints (crear, listar, borrar)
- **Interfaz web** moderna e interactiva
- **Base de datos** MariaDB con persistencia
- **Logs** en formato JSON
- **ConfiguraciÃ³n** mediante variables de entorno

## ğŸ—ï¸ Arquitectura
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚         â”‚                 â”‚
â”‚   Flask App     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚    MariaDB      â”‚
â”‚   (Puerto 5000) â”‚         â”‚   (Puerto 3306) â”‚
â”‚                 â”‚         â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                           â”‚
        â”‚                           â”‚
   notas-network              datos-mariadb
   (red interna)                (volumen)
```

## ğŸš€ Requisitos

**Para despliegue con contenedores (Recomendado):**
- Docker (v20.10 o superior)
- Docker Compose (v2.0 o superior)

**Para desarrollo local:**
- Python 3.9+
- MySQL/MariaDB (o usar Docker para la BD)

## ğŸ“¦ InstalaciÃ³n y ejecuciÃ³n

### 1. Clonar el repositorio
```bash
git clone <url-del-repositorio>
cd notas-api
```

### 2. Levantar la aplicaciÃ³n
```bash
docker compose up --build
```

### 3. Acceder a la aplicaciÃ³n

Abre el navegador en: **http://localhost:5000**

### 4. Parar la aplicaciÃ³n
```bash
docker compose down
```

Para parar y eliminar los volÃºmenes (borra los datos):
```bash
docker compose down -v
```

## ğŸ”Œ API Endpoints

| MÃ©todo | Endpoint | DescripciÃ³n |
|--------|----------|-------------|
| GET | `/` | Interfaz web |
| GET | `/notas` | Lista todas las notas |
| POST | `/notas` | Crea una nueva nota |
| DELETE | `/notas/<id>` | Elimina una nota por ID |
| GET | `/health` | Estado de la aplicaciÃ³n |

### Ejemplos con curl

**Crear una nota:**
```bash
curl -X POST http://localhost:5000/notas \
  -H "Content-Type: application/json" \
  -d '{"titulo": "Mi nota", "contenido": "Contenido de ejemplo"}'
```

**Listar notas:**
```bash
curl http://localhost:5000/notas
```

**Borrar una nota:**
```bash
curl -X DELETE http://localhost:5000/notas/1
```

## âš™ï¸ ConfiguraciÃ³n

La aplicaciÃ³n se configura mediante variables de entorno:

| Variable | DescripciÃ³n | Valor por defecto |
|----------|-------------|-------------------|
| `DB_HOST` | Host de la base de datos | `localhost` |
| `DB_PORT` | Puerto de la base de datos | `3306` |
| `DB_USER` | Usuario de la base de datos | `root` |
| `DB_PASSWORD` | ContraseÃ±a de la base de datos | `secret` |
| `DB_NAME` | Nombre de la base de datos | `notasdb` |

Estas variables estÃ¡n configuradas en `docker-compose.yml`.

## ğŸ“ Estructura del proyecto
```
notas-api/
â”œâ”€â”€ app.py                 # AplicaciÃ³n Flask
â”œâ”€â”€ requirements.txt       # Dependencias Python
â”œâ”€â”€ Dockerfile            # ConstrucciÃ³n de imagen (Multistage)
â”œâ”€â”€ docker-compose.yml    # OrquestaciÃ³n de servicios
â”œâ”€â”€ .gitignore           # Archivos ignorados por Git
â””â”€â”€ README.md            # Este archivo
```

## ğŸ³ Dockerfile (Multistage)

El Dockerfile utiliza construcciÃ³n en mÃºltiples etapas:

1. **Fase builder**: Instala dependencias en imagen completa
2. **Fase final**: Copia solo lo necesario a imagen slim

Se utiliza una imagen base `slim` en la etapa final para reducir la superficie de ataque y el tamaÃ±o, eliminando compiladores y cachÃ©s innecesarios. Esto reduce el tamaÃ±o de la imagen final (~80MB vs ~500MB).

## ğŸ“Š Logs

Los logs se emiten por STDOUT en formato JSON:
```json
{"timestamp": "2026-01-19 15:07:34", "level": "INFO", "message": "Nota creada con ID: 1"}
```

Para ver los logs:
```bash
docker logs notas-app
```

## âœ… VerificaciÃ³n del funcionamiento

1. **AplicaciÃ³n corriendo:**
```bash
   curl http://localhost:5000/health
   # Respuesta: {"status": "ok"}
```

2. **Persistencia de datos:**
   - Crear una nota
   - Parar con `docker compose down`
   - Volver a levantar con `docker compose up`
   - La nota debe seguir ahÃ­

3. **Logs funcionando:**
```bash
   docker logs notas-app | grep "level"
```

## ğŸ› ï¸ Desarrollo (EjecuciÃ³n local sin contenedor)

Si deseas ejecutar la aplicaciÃ³n Python directamente en tu mÃ¡quina:

### 1. Requisitos previos

- Python 3.9+ instalado
- Una base de datos MySQL/MariaDB corriendo en `localhost:3306`

> **Tip:** Puedes usar `docker compose up db -d` para levantar solo la BD con Docker.

### 2. ConfiguraciÃ³n del entorno
```bash
# Crear entorno virtual
python -m venv venv
source venv/bin/activate  # Linux/Mac
# venv\Scripts\activate   # Windows

# Instalar dependencias
pip install -r requirements.txt
```

### 3. Variables de entorno y ejecuciÃ³n
```bash
export DB_HOST=localhost
export DB_USER=notasuser
export DB_PASSWORD=notaspass
export DB_NAME=notasdb

python app.py
```

## ğŸ“ Autor

Antonio Prado Lorenzo - KeepCoding DevOps Bootcamp